{# Page d'un forum du site #}

{% extends 'base.html.twig' %}

{% block title %}Forum {{ forum.title }}{% endblock %}

{% block body %}

<div class="container white py-3 shadow-lg">

    <div class="card mt-4 mb-4">

        <!-- Titre du forum -->
        <h3 class="card-header text-white {{ forum.platformStyle }}">
            <a href="{{ path('forum') }}" class="text-white" title="Retour à la liste des forums">
                <i class="fas fa-arrow-circle-left"></i>
            </a>
            |
            <i class="{{ forum.platformLogo }}"></i> 
            Forum {{ forum.title }}
        </h3>

        <div class="card-header">
            <div class="row">
                <div class="col-6">
                    <span class="topic-head-sujet font-weight-bold">SUJET</span> 
                </div>
                <div class="col-2">
                    <span class="topic-head-auteur font-weight-bold">AUTEUR</span>
                </div>
                <div class="col-2">
                    <span class="topic-head-nb-message font-weight-bold">NB</span> 
                </div>
                <div class="col-2">
                    <span class="topic-head-dernier-msg font-weight-bold">DERNIER MSG</span>
                </div>
            </div> 
        </div>

        <!-- Liste des topics -->
        <ul class="list-group list-group-flush">
            {% for topic in forum.topics | reverse %}
                <li class="list-group-item p-2">
                    <div class="row">
                        <div class="col-6">
                            <!-- Titre du topic -->
                            <span class="topic-sujet"><a href="{{ path('topic_show', {'slugForum': topic.forum.slug, 'id': topic.id,'slugTopic': topic.slug}) }}">{{ topic.title }}</a></span>
                        </div>
                        <div class="col-2">
                            <!-- Le pseudo de l'auteur appraitra en rouge s'il est admin ou modérateur -->
                            <span class="topic-auteur">{{ topic.user.username }}</span>
                        </div>
                        <div class="col-2">
                            <!-- Nombre de message du topic -->
                            <span class="topic-nb-message">{{ topic.commentTopic | length }}</span>
                        </div>
                        <div class="col-2">
                            {% if topic.lastMsg is empty %}
                                <!-- Date du premier message du topic -->
                                <span class="topic-dernier-msg small">{{ topic.createdAt | date('d/m/Y') }} à {{ topic.createdAt | date('H:i') }}</span>
                            {% else %}
                                <!-- Date du dernier message du topic -->
                                <span class="topic-dernier-msg small">{{ topic.lastMsg | date('d/m/Y') }} à {{ topic.lastMsg | date('H:i') }}</span>
                            {% endif %}
                        </div>
                    </div>
                </li>
            {% endfor %}      
        </ul>

    </div>

    {% if app.user %}
    <div class="alert blue-grey lighten-5">
        {{ form_start(form) }}

        {{ form_widget(form) }}

        <div class="text-center">
            <button type="submit" class="btn btn-primary">Créer le topic</button>
        </div>
        
        {{ form_end(form) }}
    </div>
    {% else %}
        <div class="alert alert-warning">
            <h5 class="mb-0"><a href="{{ path('account_login') }}">Connectez-vous</a> pour pouvoir écrire un commentaire !</h5>
        </div>
    {% endif %}

</div>

{% endblock %}